# Проектный практикум №3: Учебная задача

---

## Команда проекта №4

Состав команды:
- Надеждин М.А.
- Селезнев Д.А.
- Зиннер Р.А.
- Ласковая И.Э.
- Каменский С.В.

---

## Генерация отзывов с помощью нейронной сети

### Краткое описание

Цель проекта — разработка нейросети, способной создавать текстовые отзывы о различных местах, используя такие параметры, как категория, средний рейтинг и ключевые слова. В рамках работы были проведены анализ, обработка и обогащение данных.

Основой проекта стал открытый датасет отзывов на российские организации, опубликованный [здесь](https://github.com/yandex/geo-reviews-dataset-2023). Он включает полмиллиона отзывов, собранных с января по июль 2023 года с платформы Яндекс Карты.

---

### Структура исходных данных

В исходном датасете представлены следующие столбцы:
- **Адрес организации** (*address*).
- **Название** (*name_ru*).
- **Категории организации** (*rubrics*).
- **Оценка пользователя** (*rating*, от 0 до 5).
- **Текст отзыва** (*text*).

---

### Этапы выполнения проекта

#### Шаг 1: Подготовка данных

1. Очистка данных:
   - Удаление пропусков и дубликатов.
   - Вычисление базовых статистических показателей.
2. Лемматизация и выделение ключевых слов:
   - Использование TF-IDF для анализа тематических терминов.
3. Коррекция распределения рейтингов:
   - Уравновешивание данных путём замены на средние оценки.
4. Геокодирование:
   - Частичное преобразование адресов в географические координаты.

#### Шаг 2: Расширение данных

- Добавлены новые признаки: ключевые слова и лемматизированный текст отзывов.
- Выполнена нормализация текстов: приведение к нижнему регистру, удаление HTML-тегов, лишних символов и пробелов.

#### Шаг 3: Визуализация

На этом этапе были построены графики распределений, которые иллюстрируют структуру данных и их распределение по рубрикам и оценкам.

---

### Обучение нейронной сети

#### Модель и её настройка

Для генерации отзывов была дообучена предобученная модель **sberbank-ai/rugpt3small_based_on_gpt2**. Её преимущества:
- Эффективность для задач генерации текста.
- Компактность, позволяющая экономить ресурсы.
- Адаптивность к тематическим данным.

Обучение модели выполнялось на Google Colab Pro (GPU Tesla A100). Основные параметры:
- **Эпохи**: 3.
- **Размер батча**: 32.
- **Максимальная длина текста**: 512 токенов.
- **Параметры генерации**: top-k = 60, top-p = 0.95, temperature = 1.

#### Токенизация

Данные были преобразованы в формат, учитывающий:
- Категории мест.
- Средние оценки.
- Ключевые слова.

#### Результаты обучения

- Генерация отзывов по заданным параметрам.
- Низкие значения perplexity (27–34), отражающие хорошую связность текстов.

---

### Оценка качества

Для анализа модель сгенерировала отзывы по пяти категориям (например, рестораны, магазины, гостиницы). Качество оценивалось:
1. **Перплексией** — мерой связности текста.
2. **Релевантностью ключевых слов**.

#### Выводы

- Модель способна создавать отзывы, охватывающие основные аспекты категорий.
- Высокая тематическая релевантность: до 87.5% ключевых слов.

---

### Итог и демонстрация

Результатом работы стала модель для генерации отзывов, доступная в виде веб-приложения: [перейти к приложению](https://huggingface.co/URFUTeam4).
